# calc.epub
JavaScriptを使わず静的なドキュメントで実現した電卓です。

デフォルトでは二ケタになっていますが、設定(``$MAXNUM=100;``)で桁数は増やせます。

## これは何？
動的な要素を利用せずに電卓を実現した、静的な電卓です。  
つまり印刷してハイパーリンクのリンク先を書き込めば物理的にも使えるはずです。

ファイル形式はepubを使っています。

似たような発想は昔からあっただろうとは思います。
ちなみにブロックヘッドといわれるのも似たような発想です。

ページ数は桁数をnとしてo(10^2n)のオーダーで、具体的には``[関数の数]*(10^2n)+10^n+c``ページといった所です。
少なくともKindleでは正数のみ二桁が限度でした。
3桁では数百メガバイト、4桁では数十ギガバイトに達するはずです。

iBooksのようなJavaScriptに対応したストアではこうしたことをわざわざする意味はないでしょう。

## 使い方
```
perl calc.pl
perl make_opf.pl
```
後は足りないファイルを補完してzip圧縮し拡張子をepubにしてください。

## Kindle版について
この本はKindleにて有料販売しています。
ぜひ買ってみてください。

* [電卓 (2桁表示)](https://www.amazon.co.jp/dp/B077XRMFWX)
* [2-Digit Display Calculator](https://www.amazon.com/dp/B0785GFGFM)

なお、ここのCalc.epubとは以下の二点で異なります。
これはKDPセレクトの規約上同一内容を無償で公開できない為です。
作成したスクリプト自体はここにあるものです。

* Kindle版では負数の計算に対応しない。
* Kindle版では±ボタンの代わりに√ボタンが採用されている。
* その他レイアウトなどが更新されている。

KindleではCSSでvw/vh/vmin/vmaxが使えないようです。
レイアウト変更は主にそのせいです。

## ファイル・ページサイズについて
KDP(Kindle Desktop Publishing)で出版する場合には処理できる規模に上限があるようです。  
二桁で負数に対応した場合、Kindle PreviewerでもKDPの登録ページ上でも変換に失敗しました。

極めて重複の多い内容ですからファイルサイズを削減したい場合には、一つのxhtmlファイルに含まれるページ数を増やせばいいです。

一方でページ数を削減するには以下の手法があり得ます。

* 逆ポーランド記法を用いる。これで関数の数を増やしてもページ数は増えません。
* 負数に対応しない。これで約四分の一の容量になります。
* 一度に二桁以上入力できるようにする。
* テーブル参照にする。

ただ誰もが使える電卓のUIである事に意味があるので、兼ね合いは判断が必要です。
